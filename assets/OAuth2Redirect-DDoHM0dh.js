import{u as p}from"./index-fTqu791Z.js";import{d as f,D as m,o as _,f as w,i as g,j as C}from"./vue-6PFCaG3D.js";import"./kongponents-3HpDyT6r.js";import"./specRenderer-IjoYWasr.js";const U=f({__name:"OAuth2Redirect",setup(b){const s=p().state.helpText.oauth2,i=m(),u=e=>{if(!e)return{};if(typeof e=="object")return Object.keys(e).reduce((a,c)=>(a[c]=decodeURIComponent(e[c]&&e[c].toString()||""),a),{});const r=(e.startsWith("#")?e.substring(1):e).split("&"),t={};return r.forEach(n=>{const[a,c]=n.split("=");t[a]=decodeURIComponent(c||"")}),t},l=()=>{const e=window.opener?window.opener.swaggerUIRedirectOauth2:null;if(!e){console.error(s.dataNotFound);return}const o=e.state,r=e.redirectUrl,t={...u(i.query),...u(i.hash)},n=t.state===o;h(e)&&!e.auth.code?(n||d(e,s.authMaybeUnsafe,"warning"),t.code?(delete e.state,e.auth.code=t.code.toString(),e.callback({auth:e.auth,redirectUrl:r})):d(e,s.defaultError,"error",t)):e.callback({auth:e.auth,token:t,isValid:n,redirectUrl:r}),window.close()},h=e=>{const o=e.auth.schema.get("flow");return o==="accessCode"||o==="authorizationCode"||o==="authorization_code"},d=(e,o,r,t={})=>{const n={authId:e.auth.name,source:"auth",level:r,message:o};t.error&&(n.message+=` [${t.error}]: ${t.error_description||s.noDescription} ${t.error_uri?s.moreInfo+t.error_uri:""}`),e.errCb(n)};return _(()=>{l()}),(e,o)=>{const r=w("KSkeleton");return g(),C(r,{rows:5,columns:5,width:100,height:20})}}});export{U as default};
