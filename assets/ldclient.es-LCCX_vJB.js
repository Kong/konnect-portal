function Q(t){function e(i,r){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=i,this.code=r}return e.prototype=new Error,e.prototype.name=t,e.prototype.constructor=e,e}const De=Q("LaunchDarklyUnexpectedResponseError"),xe=Q("LaunchDarklyInvalidEnvironmentIdError"),Ce=Q("LaunchDarklyInvalidUserError"),Pe=Q("LaunchDarklyInvalidEventKeyError"),Se=Q("LaunchDarklyInvalidArgumentError"),Ie=Q("LaunchDarklyFlagFetchError");for(var N={LDUnexpectedResponseError:De,LDInvalidEnvironmentIdError:xe,LDInvalidUserError:Ce,LDInvalidEventKeyError:Pe,LDInvalidArgumentError:Se,LDInvalidDataError:Q("LaunchDarklyInvalidDataError"),LDFlagFetchError:Ie,isHttpErrorRecoverable:function(t){return!(t>=400&&t<500)||t===400||t===408||t===429}},Oe=function(t){var e=Yt(t),i=e[0],r=e[1];return 3*(i+r)/4-r},Le=function(t){var e,i,r=Yt(t),u=r[0],n=r[1],o=new Ue(function(c,d,l){return 3*(d+l)/4-l}(0,u,n)),a=0,s=n>0?u-4:u;for(i=0;i<s;i+=4)e=G[t.charCodeAt(i)]<<18|G[t.charCodeAt(i+1)]<<12|G[t.charCodeAt(i+2)]<<6|G[t.charCodeAt(i+3)],o[a++]=e>>16&255,o[a++]=e>>8&255,o[a++]=255&e;return n===2&&(e=G[t.charCodeAt(i)]<<2|G[t.charCodeAt(i+1)]>>4,o[a++]=255&e),n===1&&(e=G[t.charCodeAt(i)]<<10|G[t.charCodeAt(i+1)]<<4|G[t.charCodeAt(i+2)]>>2,o[a++]=e>>8&255,o[a++]=255&e),o},Te=function(t){for(var e,i=t.length,r=i%3,u=[],n=16383,o=0,a=i-r;o<a;o+=n)u.push(Re(t,o,o+n>a?a:o+n));return r===1?(e=t[i-1],u.push(X[e>>2]+X[e<<4&63]+"==")):r===2&&(e=(t[i-2]<<8)+t[i-1],u.push(X[e>>10]+X[e>>4&63]+X[e<<2&63]+"=")),u.join("")},X=[],G=[],Ue=typeof Uint8Array<"u"?Uint8Array:Array,Xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nt=0;nt<64;++nt)X[nt]=Xt[nt],G[Xt.charCodeAt(nt)]=nt;function Yt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return i===-1&&(i=e),[i,i===e?0:4-i%4]}function Re(t,e,i){for(var r,u,n=[],o=e;o<i;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),n.push(X[(u=r)>>18&63]+X[u>>12&63]+X[u>>6&63]+X[63&u]);return n.join("")}G[45]=62,G[95]=63;var je={byteLength:Oe,toByteArray:Le,fromByteArray:Te},Qt=Array.isArray,Zt=Object.keys,Fe=Object.prototype.hasOwnProperty,Ae=function t(e,i){if(e===i)return!0;if(e&&i&&typeof e=="object"&&typeof i=="object"){var r,u,n,o=Qt(e),a=Qt(i);if(o&&a){if((u=e.length)!=i.length)return!1;for(r=u;r--!=0;)if(!t(e[r],i[r]))return!1;return!0}if(o!=a)return!1;var s=e instanceof Date,c=i instanceof Date;if(s!=c)return!1;if(s&&c)return e.getTime()==i.getTime();var d=e instanceof RegExp,l=i instanceof RegExp;if(d!=l)return!1;if(d&&l)return e.toString()==i.toString();var g=Zt(e);if((u=g.length)!==Zt(i).length)return!1;for(r=u;r--!=0;)if(!Fe.call(i,g[r]))return!1;for(r=u;r--!=0;)if(!t(e[n=g[r]],i[n]))return!1;return!0}return e!=e&&i!=i};const Ne=["key","ip","country","email","firstName","lastName","avatar","name"];function te(t){const e=unescape(encodeURIComponent(t));return je.fromByteArray(function(i){const r=[];for(let u=0;u<i.length;u++)r.push(i.charCodeAt(u));return r}(e))}function xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ct,x={appendUrlPath:function(t,e){return(t.endsWith("/")?t.substring(0,t.length-1):t)+(e.startsWith("/")?"":"/")+e},base64URLEncode:function(t){return te(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},btoa:te,clone:function(t){return JSON.parse(JSON.stringify(t))},deepEquals:function(t,e){return Ae(t,e)},extend:function(...t){return t.reduce((e,i)=>({...e,...i}),{})},getLDUserAgentString:function(t){const e=t.version||"?";return t.userAgent+"/"+e},objectHasOwnProperty:xt,onNextTick:function(t){setTimeout(t,0)},sanitizeContext:function(t){if(!t)return t;let e;return t.kind!==null&&t.kind!==void 0||Ne.forEach(i=>{const r=t[i];r!==void 0&&typeof r!="string"&&(e=e||{...t},e[i]=String(r))}),e||t},transformValuesToVersionedValues:function(t){const e={};for(const i in t)xt(t,i)&&(e[i]={value:t[i],version:0});return e},transformVersionedValuesToValues:function(t){const e={};for(const i in t)xt(t,i)&&(e[i]=t[i].value);return e},wrapPromiseCallback:function(t,e){const i=t.then(r=>(e&&setTimeout(()=>{e(null,r)},0),r),r=>{if(!e)return Promise.reject(r);setTimeout(()=>{e(r,null)},0)});return e?void 0:i}},$e=new Uint8Array(16);function ee(){if(!Ct&&!(Ct=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ct($e)}var Ve=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function vt(t){return typeof t=="string"&&Ve.test(t)}for(var ne,Pt,H=[],St=0;St<256;++St)H.push((St+256).toString(16).substr(1));function gt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=(H[t[e+0]]+H[t[e+1]]+H[t[e+2]]+H[t[e+3]]+"-"+H[t[e+4]]+H[t[e+5]]+"-"+H[t[e+6]]+H[t[e+7]]+"-"+H[t[e+8]]+H[t[e+9]]+"-"+H[t[e+10]]+H[t[e+11]]+H[t[e+12]]+H[t[e+13]]+H[t[e+14]]+H[t[e+15]]).toLowerCase();if(!vt(i))throw TypeError("Stringified UUID is invalid");return i}var It=0,Ot=0;function we(t){if(!vt(t))throw TypeError("Invalid UUID");var e,i=new Uint8Array(16);return i[0]=(e=parseInt(t.slice(0,8),16))>>>24,i[1]=e>>>16&255,i[2]=e>>>8&255,i[3]=255&e,i[4]=(e=parseInt(t.slice(9,13),16))>>>8,i[5]=255&e,i[6]=(e=parseInt(t.slice(14,18),16))>>>8,i[7]=255&e,i[8]=(e=parseInt(t.slice(19,23),16))>>>8,i[9]=255&e,i[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,i[11]=e/4294967296&255,i[12]=e>>>24&255,i[13]=e>>>16&255,i[14]=e>>>8&255,i[15]=255&e,i}function be(t,e,i){function r(u,n,o,a){if(typeof u=="string"&&(u=function(d){d=unescape(encodeURIComponent(d));for(var l=[],g=0;g<d.length;++g)l.push(d.charCodeAt(g));return l}(u)),typeof n=="string"&&(n=we(n)),n.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+u.length);if(s.set(n),s.set(u,n.length),(s=i(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,o){a=a||0;for(var c=0;c<16;++c)o[a+c]=s[c];return o}return gt(s)}try{r.name=t}catch{}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function re(t){return 14+(t+64>>>9<<4)+1}function Y(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function pt(t,e,i,r,u,n){return Y((o=Y(Y(e,t),Y(r,n)))<<(a=u)|o>>>32-a,i);var o,a}function q(t,e,i,r,u,n,o){return pt(e&i|~e&r,t,e,u,n,o)}function M(t,e,i,r,u,n,o){return pt(e&r|i&~r,t,e,u,n,o)}function K(t,e,i,r,u,n,o){return pt(e^i^r,t,e,u,n,o)}function _(t,e,i,r,u,n,o){return pt(i^(e|~r),t,e,u,n,o)}var He=be("v3",48,function(t){if(typeof t=="string"){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var i=0;i<e.length;++i)t[i]=e.charCodeAt(i)}return function(r){for(var u=[],n=32*r.length,o="0123456789abcdef",a=0;a<n;a+=8){var s=r[a>>5]>>>a%32&255,c=parseInt(o.charAt(s>>>4&15)+o.charAt(15&s),16);u.push(c)}return u}(function(r,u){r[u>>5]|=128<<u%32,r[re(u)-1]=u;for(var n=1732584193,o=-271733879,a=-1732584194,s=271733878,c=0;c<r.length;c+=16){var d=n,l=o,g=a,m=s;n=q(n,o,a,s,r[c],7,-680876936),s=q(s,n,o,a,r[c+1],12,-389564586),a=q(a,s,n,o,r[c+2],17,606105819),o=q(o,a,s,n,r[c+3],22,-1044525330),n=q(n,o,a,s,r[c+4],7,-176418897),s=q(s,n,o,a,r[c+5],12,1200080426),a=q(a,s,n,o,r[c+6],17,-1473231341),o=q(o,a,s,n,r[c+7],22,-45705983),n=q(n,o,a,s,r[c+8],7,1770035416),s=q(s,n,o,a,r[c+9],12,-1958414417),a=q(a,s,n,o,r[c+10],17,-42063),o=q(o,a,s,n,r[c+11],22,-1990404162),n=q(n,o,a,s,r[c+12],7,1804603682),s=q(s,n,o,a,r[c+13],12,-40341101),a=q(a,s,n,o,r[c+14],17,-1502002290),n=M(n,o=q(o,a,s,n,r[c+15],22,1236535329),a,s,r[c+1],5,-165796510),s=M(s,n,o,a,r[c+6],9,-1069501632),a=M(a,s,n,o,r[c+11],14,643717713),o=M(o,a,s,n,r[c],20,-373897302),n=M(n,o,a,s,r[c+5],5,-701558691),s=M(s,n,o,a,r[c+10],9,38016083),a=M(a,s,n,o,r[c+15],14,-660478335),o=M(o,a,s,n,r[c+4],20,-405537848),n=M(n,o,a,s,r[c+9],5,568446438),s=M(s,n,o,a,r[c+14],9,-1019803690),a=M(a,s,n,o,r[c+3],14,-187363961),o=M(o,a,s,n,r[c+8],20,1163531501),n=M(n,o,a,s,r[c+13],5,-1444681467),s=M(s,n,o,a,r[c+2],9,-51403784),a=M(a,s,n,o,r[c+7],14,1735328473),n=K(n,o=M(o,a,s,n,r[c+12],20,-1926607734),a,s,r[c+5],4,-378558),s=K(s,n,o,a,r[c+8],11,-2022574463),a=K(a,s,n,o,r[c+11],16,1839030562),o=K(o,a,s,n,r[c+14],23,-35309556),n=K(n,o,a,s,r[c+1],4,-1530992060),s=K(s,n,o,a,r[c+4],11,1272893353),a=K(a,s,n,o,r[c+7],16,-155497632),o=K(o,a,s,n,r[c+10],23,-1094730640),n=K(n,o,a,s,r[c+13],4,681279174),s=K(s,n,o,a,r[c],11,-358537222),a=K(a,s,n,o,r[c+3],16,-722521979),o=K(o,a,s,n,r[c+6],23,76029189),n=K(n,o,a,s,r[c+9],4,-640364487),s=K(s,n,o,a,r[c+12],11,-421815835),a=K(a,s,n,o,r[c+15],16,530742520),n=_(n,o=K(o,a,s,n,r[c+2],23,-995338651),a,s,r[c],6,-198630844),s=_(s,n,o,a,r[c+7],10,1126891415),a=_(a,s,n,o,r[c+14],15,-1416354905),o=_(o,a,s,n,r[c+5],21,-57434055),n=_(n,o,a,s,r[c+12],6,1700485571),s=_(s,n,o,a,r[c+3],10,-1894986606),a=_(a,s,n,o,r[c+10],15,-1051523),o=_(o,a,s,n,r[c+1],21,-2054922799),n=_(n,o,a,s,r[c+8],6,1873313359),s=_(s,n,o,a,r[c+15],10,-30611744),a=_(a,s,n,o,r[c+6],15,-1560198380),o=_(o,a,s,n,r[c+13],21,1309151649),n=_(n,o,a,s,r[c+4],6,-145523070),s=_(s,n,o,a,r[c+11],10,-1120210379),a=_(a,s,n,o,r[c+2],15,718787259),o=_(o,a,s,n,r[c+9],21,-343485551),n=Y(n,d),o=Y(o,l),a=Y(a,g),s=Y(s,m)}return[n,o,a,s]}(function(r){if(r.length===0)return[];for(var u=8*r.length,n=new Uint32Array(re(u)),o=0;o<u;o+=8)n[o>>5]|=(255&r[o/8])<<o%32;return n}(t),8*t.length))}),qe=He;function Me(t,e,i,r){switch(t){case 0:return e&i^~e&r;case 1:case 3:return e^i^r;case 2:return e&i^e&r^i&r}}function Lt(t,e){return t<<e|t>>>32-e}var Ke=be("v5",80,function(t){var e=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var r=unescape(encodeURIComponent(t));t=[];for(var u=0;u<r.length;++u)t.push(r.charCodeAt(u))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var n=t.length/4+2,o=Math.ceil(n/16),a=new Array(o),s=0;s<o;++s){for(var c=new Uint32Array(16),d=0;d<16;++d)c[d]=t[64*s+4*d]<<24|t[64*s+4*d+1]<<16|t[64*s+4*d+2]<<8|t[64*s+4*d+3];a[s]=c}a[o-1][14]=8*(t.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(t.length-1)&4294967295;for(var l=0;l<o;++l){for(var g=new Uint32Array(80),m=0;m<16;++m)g[m]=a[l][m];for(var h=16;h<80;++h)g[h]=Lt(g[h-3]^g[h-8]^g[h-14]^g[h-16],1);for(var b=i[0],C=i[1],y=i[2],k=i[3],T=i[4],j=0;j<80;++j){var P=Math.floor(j/20),A=Lt(b,5)+Me(P,C,y,k)+T+e[P]+g[j]>>>0;T=k,k=y,y=Lt(C,30)>>>0,C=b,b=A}i[0]=i[0]+b>>>0,i[1]=i[1]+C>>>0,i[2]=i[2]+y>>>0,i[3]=i[3]+k>>>0,i[4]=i[4]+T>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]}),_e=Ke,Vt=Object.freeze({__proto__:null,v1:function(t,e,i){var r=e&&i||0,u=e||new Array(16),n=(t=t||{}).node||ne,o=t.clockseq!==void 0?t.clockseq:Pt;if(n==null||o==null){var a=t.random||(t.rng||ee)();n==null&&(n=ne=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=Pt=16383&(a[6]<<8|a[7]))}var s=t.msecs!==void 0?t.msecs:Date.now(),c=t.nsecs!==void 0?t.nsecs:Ot+1,d=s-It+(c-Ot)/1e4;if(d<0&&t.clockseq===void 0&&(o=o+1&16383),(d<0||s>It)&&t.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");It=s,Ot=c,Pt=o;var l=(1e4*(268435455&(s+=122192928e5))+c)%4294967296;u[r++]=l>>>24&255,u[r++]=l>>>16&255,u[r++]=l>>>8&255,u[r++]=255&l;var g=s/4294967296*1e4&268435455;u[r++]=g>>>8&255,u[r++]=255&g,u[r++]=g>>>24&15|16,u[r++]=g>>>16&255,u[r++]=o>>>8|128,u[r++]=255&o;for(var m=0;m<6;++m)u[r+m]=n[m];return e||gt(u)},v3:qe,v4:function(t,e,i){var r=(t=t||{}).random||(t.rng||ee)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){i=i||0;for(var u=0;u<16;++u)e[i+u]=r[u];return e}return gt(r)},v5:_e,NIL:"00000000-0000-0000-0000-000000000000",version:function(t){if(!vt(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)},validate:vt,stringify:gt,parse:we});const it=["debug","info","warn","error","none"];var Ht={commonBasicLogger:function(t,e){if(t&&t.destination&&typeof t.destination!="function")throw new Error("destination for basicLogger was set to a non-function");function i(c){return function(d){console&&console[c]&&console[c].call(console,d)}}const r=t&&t.destination?[t.destination,t.destination,t.destination,t.destination]:[i("log"),i("info"),i("warn"),i("error")],u=!(!t||!t.destination),n=t&&t.prefix!==void 0&&t.prefix!==null?t.prefix:"[LaunchDarkly] ";let o=1;if(t&&t.level)for(let c=0;c<it.length;c++)it[c]===t.level&&(o=c);function a(c,d,l){if(l.length<1)return;let g;const m=u?d+": "+n:n;if(l.length!==1&&e){const h=[...l];h[0]=m+h[0],g=e(...h)}else g=m+l[0];try{r[c](g)}catch(h){console&&console.log&&console.log("[LaunchDarkly] Configured logger's "+d+" method threw an exception: "+h)}}const s={};for(let c=0;c<it.length;c++){const d=it[c];if(d!=="none")if(c<o)s[d]=()=>{};else{const l=c;s[d]=function(){a(l,d,arguments)}}}return s},validateLogger:function(t){it.forEach(e=>{if(e!=="none"&&(!t[e]||typeof t[e]!="function"))throw new Error("Provided logger instance must support logger."+e+"(...) method")})}};function st(t){return t&&t.message?t.message:typeof t=="string"||t instanceof String?t:JSON.stringify(t)}const rt=" Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initializing-the-client for instructions on SDK initialization.";var E={bootstrapInvalid:function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},bootstrapOldFormat:function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+rt},clientInitialized:function(){return"LaunchDarkly client initialized"},clientNotReady:function(){return"LaunchDarkly client is not ready"},debugEnqueueingEvent:function(t){return'enqueueing "'+t+'" event'},debugPostingDiagnosticEvent:function(t){return"sending diagnostic event ("+t.kind+")"},debugPostingEvents:function(t){return"sending "+t+" events"},debugStreamDelete:function(t){return'received streaming deletion for flag "'+t+'"'},debugStreamDeleteIgnored:function(t){return'received streaming deletion for flag "'+t+'" but ignored due to version check'},debugStreamPatch:function(t){return'received streaming update for flag "'+t+'"'},debugStreamPatchIgnored:function(t){return'received streaming update for flag "'+t+'" but ignored due to version check'},debugStreamPing:function(){return"received ping message from stream"},debugPolling:function(t){return"polling for feature flags at "+t},debugStreamPut:function(){return"received streaming update for all flags"},deprecated:function(t,e){return e?'"'+t+'" is deprecated, please use "'+e+'"':'"'+t+'" is deprecated'},environmentNotFound:function(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+rt},environmentNotSpecified:function(){return"No environment/client-side ID was specified."+rt},errorFetchingFlags:function(t){return"Error fetching flag settings: "+st(t)},eventCapacityExceeded:function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},eventWithoutContext:function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"},httpErrorMessage:function(t,e,i){return"Received error "+t+(t===401?" (invalid SDK key)":"")+" for "+e+" - "+(N.isHttpErrorRecoverable(t)?i:"giving up permanently")},httpUnavailable:function(){return"Cannot make HTTP requests in this environment."+rt},identifyDisabled:function(){return"identify() has no effect here; it must be called on the main client instance"},inspectorMethodError:(t,e)=>`an inspector: "${e}" of type: "${t}" generated an exception`,invalidContentType:function(t){return'Expected application/json content type but got "'+t+'"'},invalidData:function(){return"Invalid data received from LaunchDarkly; connection may have been interrupted"},invalidInspector:(t,e)=>`an inspector: "${e}" of an invalid type (${t}) was configured`,invalidKey:function(){return"Event key must be a string"},invalidContext:function(){return"Invalid context specified."+rt},invalidTagValue:t=>`Config option "${t}" must only contain letters, numbers, ., _ or -.`,localStorageUnavailable:function(t){return"local storage is unavailable: "+st(t)},networkError:t=>"network error"+(t?" ("+t+")":""),optionBelowMinimum:(t,e,i)=>'Config option "'+t+'" was set to '+e+", changing to minimum value of "+i,streamClosing:function(){return"Closing stream connection"},streamConnecting:function(t){return"Opening stream connection to "+t},streamError:function(t,e){return"Error on stream connection: "+st(t)+", will continue retrying after "+e+" milliseconds."},tagValueTooLong:t=>`Value of "${t}" was longer than 64 characters and was discarded.`,unknownCustomEventKey:function(t){return'Custom event "'+t+'" does not exist'},unknownOption:t=>'Ignoring unknown config option "'+t+'"',contextNotSpecified:function(){return"No context specified."+rt},unrecoverableStreamError:t=>`Error on stream connection ${st(t)}, giving up permanently`,wrongOptionType:(t,e,i)=>'Config option "'+t+'" should be of type '+e+", got "+i+", using default value",wrongOptionTypeBoolean:(t,e)=>'Config option "'+t+'" should be a boolean, got '+e+", converting to boolean"};const{validateLogger:ze}=Ht,oe={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},requestHeaderTransform:{type:"function"},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributes:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},application:{validator:function(t,e,i){const r={};return e.id&&(r.id=ie(`${t}.id`,e.id,i)),e.version&&(r.version=ie(`${t}.version`,e.version,i)),r}},inspectors:{default:[]}},Je=/^(\w|\.|-)+$/;function Tt(t){return t&&t.replace(/\/+$/,"")}function ie(t,e,i){if(typeof e=="string"&&e.match(Je)){if(!(e.length>64))return e;i.warn(E.tagValueTooLong(t))}else i.warn(E.invalidTagValue(t))}var qt={baseOptionDefs:oe,validate:function(t,e,i,r){const u=x.extend({logger:{default:r}},oe,i),n={};function o(s){x.onNextTick(()=>{e&&e.maybeReportError(new N.LDInvalidArgumentError(s))})}let a=x.extend({},t||{});return function(s){const c=s;Object.keys(n).forEach(d=>{if(c[d]!==void 0){const l=n[d];r&&r.warn(E.deprecated(d,l)),l&&(c[l]===void 0&&(c[l]=c[d]),delete c[d])}})}(a),a=function(s){const c=x.extend({},s);return Object.keys(u).forEach(d=>{c[d]!==void 0&&c[d]!==null||(c[d]=u[d]&&u[d].default)}),c}(a),a=function(s){const c=x.extend({},s),d=l=>{if(l===null)return"any";if(l===void 0)return;if(Array.isArray(l))return"array";const g=typeof l;return g==="boolean"||g==="string"||g==="number"||g==="function"?g:"object"};return Object.keys(s).forEach(l=>{const g=s[l];if(g!=null){const m=u[l];if(m===void 0)o(E.unknownOption(l));else{const h=m.type||d(m.default),b=m.validator;if(b){const C=b(l,s[l],r);C!==void 0?c[l]=C:delete c[l]}else if(h!=="any"){const C=h.split("|"),y=d(g);C.indexOf(y)<0?h==="boolean"?(c[l]=!!g,o(E.wrongOptionTypeBoolean(l,y))):(o(E.wrongOptionType(l,h,y)),c[l]=m.default):y==="number"&&m.minimum!==void 0&&g<m.minimum&&(o(E.optionBelowMinimum(l,g,m.minimum)),c[l]=m.minimum)}}}}),c.baseUrl=Tt(c.baseUrl),c.streamUrl=Tt(c.streamUrl),c.eventsUrl=Tt(c.eventsUrl),c}(a),ze(a.logger),a},getTags:function(t){const e={};return t&&(t.application&&t.application.id!==void 0&&t.application.id!==null&&(e["application-id"]=[t.application.id]),t.application&&t.application.version!==void 0&&t.application.id!==null&&(e["application-version"]=[t.application.version])),e}};const{getLDUserAgentString:Be}=x;var Mt={getLDHeaders:function(t,e){if(e&&!e.sendLDHeaders)return{};const i={};i[t.userAgentHeaderName||"User-Agent"]=Be(t),e&&e.wrapperName&&(i["X-LaunchDarkly-Wrapper"]=e.wrapperVersion?e.wrapperName+"/"+e.wrapperVersion:e.wrapperName);const r=qt.getTags(e),u=Object.keys(r);return u.length&&(i["x-launchdarkly-tags"]=u.sort().map(n=>Array.isArray(r[n])?r[n].sort().map(o=>`${n}/${o}`):[`${n}/${r[n]}`]).reduce((n,o)=>n.concat(o),[]).join(" ")),i},transformHeaders:function(t,e){return e&&e.requestHeaderTransform?e.requestHeaderTransform({...t}):t}};const{v1:Ge}=Vt,{getLDHeaders:We,transformHeaders:Xe}=Mt;var ke=function(t,e,i){const r=x.extend({"Content-Type":"application/json"},We(t,i)),u={};return u.sendEvents=(n,o,a)=>{if(!t.httpRequest)return Promise.resolve();const s=JSON.stringify(n),c=a?null:Ge();return function d(l){const g=a?r:x.extend({},r,{"X-LaunchDarkly-Event-Schema":"4","X-LaunchDarkly-Payload-ID":c});return t.httpRequest("POST",o,Xe(g,i),s).promise.then(m=>{if(m)return m.status>=400&&N.isHttpErrorRecoverable(m.status)&&l?d(!1):function(h){const b={status:h.status},C=h.header("date");if(C){const y=Date.parse(C);y&&(b.serverTime=y)}return b}(m)}).catch(()=>l?d(!1):Promise.reject())}(!0).catch(()=>{})},u};const{commonBasicLogger:Ye}=Ht;function ae(t){return typeof t=="string"&&t!=="kind"&&t.match(/^(\w|\.|-)+$/)}function se(t){return t.includes("%")||t.includes(":")?t.replace(/%/g,"%25").replace(/:/g,"%3A"):t}var mt={checkContext:function(t,e){if(t){if(e&&(t.kind===void 0||t.kind===null))return t.key!==void 0&&t.key!==null;const i=t.key,r=t.kind===void 0?"user":t.kind,u=ae(r),n=r==="multi"||i!=null&&i!=="";if(r==="multi"){const o=Object.keys(t).filter(a=>a!=="kind");return n&&o.every(a=>ae(a))&&o.every(a=>{const s=t[a].key;return s!=null&&s!==""})}return n&&u}return!1},getContextKeys:function(t,e=Ye()){if(!t)return;const i={},{kind:r,key:u}=t;switch(r){case void 0:i.user=`${u}`;break;case"multi":Object.entries(t).filter(([n])=>n!=="kind").forEach(([n,o])=>{o&&o.key&&(i[n]=o.key)});break;case null:e.warn(`null is not a valid context kind: ${t}`);break;case"":e.warn(`'' is not a valid context kind: ${t}`);break;default:i[r]=`${u}`}return i},getContextKinds:function(t){return t?t.kind===null||t.kind===void 0?["user"]:t.kind!=="multi"?[t.kind]:Object.keys(t).filter(e=>e!=="kind"):[]},getCanonicalKey:function(t){if(t){if((t.kind===void 0||t.kind===null||t.kind==="user")&&t.key)return t.key;if(t.kind!=="multi"&&t.key)return`${t.kind}:${se(t.key)}`;if(t.kind==="multi")return Object.keys(t).sort().filter(e=>e!=="kind").map(e=>`${e}:${se(t[e].key)}`).join(":")}}};const{getContextKinds:Qe}=mt;var Ze=function(){const t={};let e=0,i=0,r={},u={};return t.summarizeEvent=n=>{if(n.kind==="feature"){const o=n.key+":"+(n.variation!==null&&n.variation!==void 0?n.variation:"")+":"+(n.version!==null&&n.version!==void 0?n.version:""),a=r[o];let s=u[n.key];s||(s=new Set,u[n.key]=s),function(c){return c.context?Qe(c.context):c.contextKeys?Object.keys(c.contextKeys):[]}(n).forEach(c=>s.add(c)),a?a.count=a.count+1:r[o]={count:1,key:n.key,version:n.version,variation:n.variation,value:n.value,default:n.default},(e===0||n.creationDate<e)&&(e=n.creationDate),n.creationDate>i&&(i=n.creationDate)}},t.getSummary=()=>{const n={};let o=!0;for(const a of Object.values(r)){let s=n[a.key];s||(s={default:a.default,counters:[],contextKinds:[...u[a.key]]},n[a.key]=s);const c={value:a.value,count:a.count};a.variation!==void 0&&a.variation!==null&&(c.variation=a.variation),a.version!==void 0&&a.version!==null?c.version=a.version:c.unknown=!0,s.counters.push(c),o=!1}return o?null:{startDate:e,endDate:i,features:n}},t.clearSummary=()=>{e=0,i=0,r={},u={}},t};function Ee(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function ce(t){return(t.startsWith("/")?t.substring(1):t).split("/").map(e=>e.indexOf("~")>=0?e.replace(/~1/g,"/").replace(/~0/g,"~"):e)}function ue(t){return!t.startsWith("/")}function le(t,e){const i=ue(t),r=ue(e);if(i&&r)return t===e;if(i){const u=ce(e);return u.length===1&&t===u[0]}if(r){const u=ce(t);return u.length===1&&e===u[0]}return t===e}function de(t){return`/${Ee(t)}`}var Ut={cloneExcluding:function(t,e){const i=[],r={},u=[];for(i.push(...Object.keys(t).map(n=>({key:n,ptr:de(n),source:t,parent:r,visited:[t]})));i.length;){const n=i.pop();if(e.some(o=>le(o,n.ptr)))u.push(n.ptr);else{const o=n.source[n.key];if(o===null)n.parent[n.key]=o;else if(Array.isArray(o))n.parent[n.key]=[...o];else if(typeof o=="object"){if(n.visited.includes(o))continue;n.parent[n.key]={},i.push(...Object.keys(o).map(a=>{return{key:a,ptr:(s=n.ptr,c=Ee(a),`${s}/${c}`),source:o,parent:n.parent[n.key],visited:[...n.visited,o]};var s,c}))}else n.parent[n.key]=o}}return{cloned:r,excluded:u.sort()}},compare:le,literalToReference:de},tn=function(t){const e={},i=t.allAttributesPrivate,r=t.privateAttributes||[],u=["key","kind","_meta","anonymous"],n=["name","ip","firstName","lastName","email","avatar","country"],o=(a,s)=>{if(typeof a!="object"||a===null||Array.isArray(a))return;const{cloned:c,excluded:d}=Ut.cloneExcluding(a,((l,g)=>(i||g&&l.anonymous?Object.keys(l):[...r,...l._meta&&l._meta.privateAttributes||[]]).filter(m=>!u.some(h=>Ut.compare(m,h))))(a,s));return c.key=String(c.key),d.length&&(c._meta||(c._meta={}),c._meta.redactedAttributes=d),c._meta&&(delete c._meta.privateAttributes,Object.keys(c._meta).length===0&&delete c._meta),c.anonymous!==void 0&&(c.anonymous=!!c.anonymous),c};return e.filter=(a,s=!1)=>a.kind===void 0||a.kind===null?o((c=>{const d={...c.custom||{},kind:"user",key:c.key};c.anonymous!==void 0&&(d.anonymous=!!c.anonymous);for(const l of n)delete d[l],c[l]!==void 0&&c[l]!==null&&(d[l]=String(c[l]));return c.privateAttributeNames!==void 0&&c.privateAttributeNames!==null&&(d._meta=d._meta||{},d._meta.privateAttributes=c.privateAttributeNames.map(l=>l.startsWith("/")?Ut.literalToReference(l):l)),d})(a),s):a.kind==="multi"?((c,d)=>{const l={kind:c.kind},g=Object.keys(c);for(const m of g)if(m!=="kind"){const h=o(c[m],d);h&&(l[m]=h)}return l})(a,s):o(a,s),e};const{getContextKeys:en}=mt;var nn=function(t,e,i,r=null,u=null,n=null){const o={},a=n||ke(t,i,e),s=x.appendUrlPath(e.eventsUrl,"/events/bulk/"+i),c=Ze(),d=tn(e),l=e.samplingInterval,g=e.eventCapacity,m=e.flushInterval,h=e.logger;let b,C=[],y=0,k=!1,T=!1;function j(){return l===0||Math.floor(Math.random()*l)===0}function P(D){const R=x.extend({},D);return D.kind==="identify"?R.context=d.filter(D.context):D.kind==="feature"?R.context=d.filter(D.context,!0):(R.contextKeys=en(D.context,h),delete R.context),D.kind==="feature"&&(delete R.trackEvents,delete R.debugEventsUntilDate),R}function A(D){C.length<g?(C.push(D),T=!1):(T||(T=!0,h.warn(E.eventCapacityExceeded())),r&&r.incrementDroppedEvents())}return o.enqueue=function(D){if(k)return;let R=!1,w=!1;var S;if(c.summarizeEvent(D),D.kind==="feature"?j()&&(R=!!D.trackEvents,w=!!(S=D).debugEventsUntilDate&&S.debugEventsUntilDate>y&&S.debugEventsUntilDate>new Date().getTime()):R=j(),R&&A(P(D)),w){const U=x.extend({},D,{kind:"debug"});U.context=d.filter(U.context),delete U.trackEvents,delete U.debugEventsUntilDate,A(U)}},o.flush=function(){if(k)return Promise.resolve();const D=C,R=c.getSummary();return c.clearSummary(),R&&(R.kind="summary",D.push(R)),r&&r.setEventsInLastBatch(D.length),D.length===0?Promise.resolve():(C=[],h.debug(E.debugPostingEvents(D.length)),a.sendEvents(D,s).then(w=>{w&&(w.serverTime&&(y=w.serverTime),N.isHttpErrorRecoverable(w.status)||(k=!0),w.status>=400&&x.onNextTick(()=>{u.maybeReportError(new N.LDUnexpectedResponseError(E.httpErrorMessage(w.status,"event posting","some events were dropped")))}))}))},o.start=function(){const D=()=>{o.flush(),b=setTimeout(D,m)};b=setTimeout(D,m)},o.stop=function(){clearTimeout(b)},o},rn=function(t){const e={},i={};return e.on=function(r,u,n){i[r]=i[r]||[],i[r]=i[r].concat({handler:u,context:n})},e.off=function(r,u,n){if(i[r])for(let o=0;o<i[r].length;o++)i[r][o].handler===u&&i[r][o].context===n&&(i[r]=i[r].slice(0,o).concat(i[r].slice(o+1)))},e.emit=function(r){if(!i[r])return;const u=i[r].slice(0);for(let n=0;n<u.length;n++)u[n].handler.apply(u[n].context,Array.prototype.slice.call(arguments,1))},e.getEvents=function(){return Object.keys(i)},e.getEventListenerCount=function(r){return i[r]?i[r].length:0},e.maybeReportError=function(r){r&&(i.error?this.emit("error",r):(t||console).error(r.message))},e};const ct="ready",Rt="initialized",jt="failed";var on=function(t){let e=!1,i=!1,r=null,u=null;const n=new Promise(o=>{const a=()=>{t.off(ct,a),o()};t.on(ct,a)}).catch(()=>{});return{getInitializationPromise:()=>u||(e?Promise.resolve():i?Promise.reject(r):(u=new Promise((o,a)=>{const s=()=>{t.off(Rt,s),o()},c=d=>{t.off(jt,c),a(d)};t.on(Rt,s),t.on(jt,c)}),u)),getReadyPromise:()=>n,signalSuccess:()=>{e||i||(e=!0,t.emit(Rt),t.emit(ct))},signalFailure:o=>{e||i||(i=!0,r=o,t.emit(jt,o),t.emit(ct)),t.maybeReportError(o)}}},an=function(t,e,i,r){const u={};function n(){let o="";const a=r.getContext();return a&&(o=i||x.btoa(JSON.stringify(a))),"ld:"+e+":"+o}return u.loadFlags=()=>t.get(n()).then(o=>{if(o==null)return null;try{let a=JSON.parse(o);if(a){const s=a.$schema;s===void 0||s<1?a=x.transformValuesToVersionedValues(a):delete a.$schema}return a}catch{return u.clearFlags().then(()=>null)}}),u.saveFlags=o=>{const a=x.extend({},o,{$schema:1});return t.set(n(),JSON.stringify(a))},u.clearFlags=()=>t.clear(n()),u},sn=function(t,e){const i={};let r=!1;const u=n=>{r||(r=!0,e.warn(E.localStorageUnavailable(n)))};return i.isEnabled=()=>!!t,i.get=n=>new Promise(o=>{t?t.get(n).then(o).catch(a=>{u(a),o(void 0)}):o(void 0)}),i.set=(n,o)=>new Promise(a=>{t?t.set(n,o).then(()=>a(!0)).catch(s=>{u(s),a(!1)}):a(!1)}),i.clear=n=>new Promise(o=>{t?t.clear(n).then(()=>o(!0)).catch(a=>{u(a),o(!1)}):o(!1)}),i};const{appendUrlPath:fe,base64URLEncode:cn,objectHasOwnProperty:un}=x,{getLDHeaders:ln,transformHeaders:dn}=Mt,{isHttpErrorRecoverable:fn}=N;var gn=function(t,e,i,r){const u=e.streamUrl,n=e.logger,o={},a=fe(u,"/eval/"+i),s=e.useReport,c=e.evaluationReasons,d=e.streamReconnectDelay,l=ln(t,e);let g,m=!1,h=null,b=null,C=null,y=null,k=null,T=0;function j(){const S=(U=function(){const $=d*Math.pow(2,T);return $>3e4?3e4:$}(),U-Math.trunc(.5*Math.random()*U));var U;return T+=1,S}function P(S){if(S.status&&typeof S.status=="number"&&!fn(S.status))return R(),n.error(E.unrecoverableStreamError(S)),void(b&&(clearTimeout(b),b=null));const U=j();m||(n.warn(E.streamError(S,U)),m=!0),w(!1),R(),A(U)}function A(S){b||(S?b=setTimeout(D,S):D())}function D(){let S;b=null;let U="";const $={headers:l,readTimeoutMillis:3e5};if(t.eventSourceFactory){y!=null&&(U="h="+y),s?t.eventSourceAllowsReport?(S=a,$.method="REPORT",$.headers["Content-Type"]="application/json",$.body=JSON.stringify(C)):(S=fe(u,"/ping/"+i),U=""):S=a+"/"+cn(JSON.stringify(C)),$.headers=dn($.headers,e),c&&(U=U+(U?"&":"")+"withReasons=true"),S=S+(U?"?":"")+U,R(),n.info(E.streamConnecting(S)),g=new Date().getTime(),h=t.eventSourceFactory(S,$);for(const W in k)un(k,W)&&h.addEventListener(W,k[W]);h.onerror=P,h.onopen=()=>{T=0}}}function R(){h&&(n.info(E.streamClosing()),h.close(),h=null)}function w(S){g&&r&&r.recordStreamInit(g,!S,new Date().getTime()-g),g=null}return o.connect=function(S,U,$){C=S,y=U,k={};for(const W in $||{})k[W]=function(B){m=!1,w(!0),$[W]&&$[W](B)};A()},o.disconnect=function(){clearTimeout(b),b=null,R()},o.isConnected=function(){return!!(h&&t.eventSourceIsActive&&t.eventSourceIsActive(h))},o},vn=function(t){let e,i,r,u;const n={addPromise:(o,a)=>{e=o,i&&i(),i=a,o.then(s=>{e===o&&(r(s),t&&t())},s=>{e===o&&(u(s),t&&t())})}};return n.resultPromise=new Promise((o,a)=>{r=o,u=a}),n};const{transformHeaders:pn,getLDHeaders:mn}=Mt,ge="application/json";var hn=function(t,e,i){const r=e.baseUrl,u=e.useReport,n=e.evaluationReasons,o=e.logger,a={},s={};function c(d,l){if(!t.httpRequest)return new Promise((y,k)=>{k(new N.LDFlagFetchError(E.httpUnavailable()))});const g=l?"REPORT":"GET",m=mn(t,e);l&&(m["Content-Type"]=ge);let h=s[d];h||(h=vn(()=>{delete s[d]}),s[d]=h);const b=t.httpRequest(g,d,pn(m,e),l),C=b.promise.then(y=>{if(y.status===200){if(y.header("content-type")&&y.header("content-type").substring(0,16)===ge)return JSON.parse(y.body);{const k=E.invalidContentType(y.header("content-type")||"");return Promise.reject(new N.LDFlagFetchError(k))}}return Promise.reject(function(k){return k.status===404?new N.LDInvalidEnvironmentIdError(E.environmentNotFound()):new N.LDFlagFetchError(E.errorFetchingFlags(k.statusText||String(k.status)))}(y))},y=>Promise.reject(new N.LDFlagFetchError(E.networkError(y))));return h.addPromise(C,()=>{b.cancel&&b.cancel()}),h.resultPromise}return a.fetchJSON=function(d){return c(x.appendUrlPath(r,d),null)},a.fetchFlagSettings=function(d,l){let g,m,h,b="";return u?(m=[r,"/sdk/evalx/",i,"/context"].join(""),h=JSON.stringify(d)):(g=x.base64URLEncode(JSON.stringify(d)),m=[r,"/sdk/evalx/",i,"/contexts/",g].join("")),l&&(b="h="+l),n&&(b=b+(b?"&":"")+"withReasons=true"),m=m+(b?"?":"")+b,o.debug(E.debugPolling(m)),c(m,h)},a},yn=function(t,e){const i={};let r;return i.setContext=function(u){r=x.sanitizeContext(u),r&&e&&e(x.clone(r))},i.getContext=function(){return r?x.clone(r):null},t&&i.setContext(t),i};const{v1:wn}=Vt,{getContextKinds:bn}=mt;var kn=function(t){function e(r){return r==null||r==="user"?"ld:$anonUserId":`ld:$contextKey:${r}`}function i(r,u){return u.key!==null&&u.key!==void 0?(u.key=u.key.toString(),Promise.resolve(u)):u.anonymous?function(n){return t.get(e(n))}(r).then(n=>{if(n)return u.key=n,u;{const o=wn();return u.key=o,function(a,s){return t.set(e(s),a)}(o,r).then(()=>u)}}):Promise.reject(new N.LDInvalidUserError(E.invalidContext()))}this.processContext=r=>{if(!r)return Promise.reject(new N.LDInvalidUserError(E.contextNotSpecified()));const u=x.clone(r);if(r.kind==="multi"){const n=bn(u);return Promise.all(n.map(o=>i(o,u[o]))).then(()=>u)}return i(r.kind,u)}};const{v1:En}=Vt,{baseOptionDefs:Ft}=qt,{appendUrlPath:Dn}=x;var At={DiagnosticId:function(t){const e={diagnosticId:En()};return t&&(e.sdkKeySuffix=t.length>6?t.substring(t.length-6):t),e},DiagnosticsAccumulator:function(t){let e,i,r,u;function n(o){e=o,i=0,r=0,u=[]}return n(t),{getProps:()=>({dataSinceDate:e,droppedEvents:i,eventsInLastBatch:r,streamInits:u}),setProps:o=>{e=o.dataSinceDate,i=o.droppedEvents||0,r=o.eventsInLastBatch||0,u=o.streamInits||[]},incrementDroppedEvents:()=>{i++},setEventsInLastBatch:o=>{r=o},recordStreamInit:(o,a,s)=>{const c={timestamp:o,failed:a,durationMillis:s};u.push(c)},reset:n}},DiagnosticsManager:function(t,e,i,r,u,n,o){const a=!!t.diagnosticUseCombinedEvent,s="ld:"+u+":$diagnostics",c=Dn(n.eventsUrl,"/events/diagnostic/"+u),d=n.diagnosticRecordingInterval,l=i;let g,m,h=!!n.streaming;const b={};function C(){return{sdk:T(),configuration:j(),platform:t.diagnosticPlatformData}}function y(P){n.logger&&n.logger.debug(E.debugPostingDiagnosticEvent(P)),r.sendEvents(P,c,!0).then(()=>{}).catch(()=>{})}function k(){y(function(){const P=new Date().getTime();let A={kind:a?"diagnostic-combined":"diagnostic",id:o,creationDate:P,...l.getProps()};return a&&(A={...A,...C()}),l.reset(P),A}()),m=setTimeout(k,d),g=new Date().getTime(),a&&function(){if(e.isEnabled()){const P={...l.getProps()};e.set(s,JSON.stringify(P))}}()}function T(){const P={...t.diagnosticSdkData};return n.wrapperName&&(P.wrapperName=n.wrapperName),n.wrapperVersion&&(P.wrapperVersion=n.wrapperVersion),P}function j(){return{customBaseURI:n.baseUrl!==Ft.baseUrl.default,customStreamURI:n.streamUrl!==Ft.streamUrl.default,customEventsURI:n.eventsUrl!==Ft.eventsUrl.default,eventsCapacity:n.eventCapacity,eventsFlushIntervalMillis:n.flushInterval,reconnectTimeMillis:n.streamReconnectDelay,streamingDisabled:!h,allAttributesPrivate:!!n.allAttributesPrivate,diagnosticRecordingIntervalMillis:n.diagnosticRecordingInterval,usingSecureMode:!!n.hash,bootstrapMode:!!n.bootstrap,fetchGoalsDisabled:!n.fetchGoals,sendEventsOnlyForVariation:!!n.sendEventsOnlyForVariation}}return b.start=()=>{a?function(P){if(!e.isEnabled())return P(!1);e.get(s).then(A=>{if(A)try{const D=JSON.parse(A);l.setProps(D),g=D.dataSinceDate}catch{}P(!0)}).catch(()=>{P(!1)})}(P=>{if(P){const A=(g||0)+d,D=new Date().getTime();D>=A?k():m=setTimeout(k,A-D)}else Math.floor(4*Math.random())===0?k():m=setTimeout(k,d)}):(y({kind:"diagnostic-init",id:o,creationDate:l.getProps().dataSinceDate,...C()}),m=setTimeout(k,d))},b.stop=()=>{m&&clearTimeout(m)},b.setStreaming=P=>{h=P},b}},xn=function(t,e){let i=!1;const r={type:t.type,name:t.name,method:(...u)=>{try{t.method(...u)}catch{i||(i=!0,e.warn(E.inspectorMethodError(r.type,r.name)))}}};return r};const{onNextTick:ut}=x,J={flagUsed:"flag-used",flagDetailsChanged:"flag-details-changed",flagDetailChanged:"flag-detail-changed",clientIdentityChanged:"client-identity-changed"};Object.freeze(J);var Cn={InspectorTypes:J,InspectorManager:function(t,e){const i={},r={[J.flagUsed]:[],[J.flagDetailsChanged]:[],[J.flagDetailChanged]:[],[J.clientIdentityChanged]:[]},u=t&&t.map(n=>xn(n,e));return u&&u.forEach(n=>{Object.prototype.hasOwnProperty.call(r,n.type)?r[n.type].push(n):e.warn(E.invalidInspector(n.type,n.name))}),i.hasListeners=n=>r[n]&&r[n].length,i.onFlagUsed=(n,o,a)=>{r[J.flagUsed].length&&ut(()=>{r[J.flagUsed].forEach(s=>s.method(n,o,a))})},i.onFlags=n=>{r[J.flagDetailsChanged].length&&ut(()=>{r[J.flagDetailsChanged].forEach(o=>o.method(n))})},i.onFlagChanged=(n,o)=>{r[J.flagDetailChanged].length&&ut(()=>{r[J.flagDetailChanged].forEach(a=>a.method(n,o))})},i.onIdentityChanged=n=>{r[J.clientIdentityChanged].length&&ut(()=>{r[J.clientIdentityChanged].forEach(o=>o.method(n))})},i}};const{commonBasicLogger:ve}=Ht,{checkContext:Pn,getContextKeys:Sn}=mt,{InspectorTypes:lt,InspectorManager:In}=Cn,dt="change",pe="internal-change";var ht={initialize:function(t,e,i,r,u){const n=function(){return i&&i.logger?i.logger:u&&u.logger&&u.logger.default||ve("warn")}(),o=rn(n),a=on(o),s=qt.validate(i,o,u,n),c=In(s.inspectors,n),d=s.sendEvents;let l=t,g=s.hash;const m=sn(r.localStorage,n),h=ke(r,l,s),b=s.sendEvents&&!s.diagnosticOptOut,C=b?At.DiagnosticId(l):null,y=b?At.DiagnosticsAccumulator(new Date().getTime()):null,k=b?At.DiagnosticsManager(r,m,y,h,l,s,C):null,T=gn(r,s,l,y),j=s.eventProcessor||nn(r,s,l,y,o,h),P=hn(r,s,l);let A,D,R,w={},S=s.streaming,U=!1,$=!1,W=!0;const B=s.stateProvider,V=yn(null,function(f){(function(p){B||p&&at({kind:"identify",context:p,creationDate:new Date().getTime()})})(f),c.hasListeners(lt.clientIdentityChanged)&&c.onIdentityChanged(V.getContext())}),Kt=new kn(m),Z=m.isEnabled()?an(m,l,g,V):null;function at(f){l&&(B&&B.enqueueEvent&&B.enqueueEvent(f)||(f.context?(W=!1,!d||$||r.isDoNotTrack()||(n.debug(E.debugEnqueueingEvent(f.kind)),j.enqueue(f))):W&&(n.warn(E.eventWithoutContext()),W=!1)))}function _t(f,p){c.hasListeners(lt.flagDetailChanged)&&c.onFlagChanged(f.key,tt(p))}function zt(){c.hasListeners(lt.flagDetailsChanged)&&c.onFlags(Object.entries(w).map(([f,p])=>({key:f,detail:tt(p)})).reduce((f,p)=>(f[p.key]=p.detail,f),{}))}function Jt(f,p,v,I){const O=V.getContext(),F=new Date,L={kind:"feature",key:f,context:O,value:p?p.value:null,variation:p?p.variationIndex:null,default:v,creationDate:F.getTime()},z=w[f];z&&(L.version=z.flagVersion?z.flagVersion:z.version,L.trackEvents=z.trackEvents,L.debugEventsUntilDate=z.debugEventsUntilDate),(I||z&&z.trackReason)&&p&&(L.reason=p.reason),at(L)}function Bt(f){return Pn(f,!1)?Promise.resolve(f):Promise.reject(new N.LDInvalidUserError(E.invalidContext()))}function yt(f,p,v,I,O){let F;if(w&&x.objectHasOwnProperty(w,f)&&w[f]&&!w[f].deleted){const L=w[f];F=tt(L),L.value!==null&&L.value!==void 0||(F.value=p)}else F={value:p,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}};return v&&Jt(f,F,p,I),O||function(L,z){c.hasListeners(lt.flagUsed)&&c.onFlagUsed(L,z,V.getContext())}(f,F),F}function tt(f){return{value:f.value,variationIndex:f.variation===void 0?null:f.variation,reason:f.reason||null}}function Gt(){if(D=!0,!V.getContext())return;const f=p=>{try{return JSON.parse(p)}catch{return void o.maybeReportError(new N.LDInvalidDataError(E.invalidData()))}};T.connect(V.getContext(),g,{ping:function(){n.debug(E.debugStreamPing());const p=V.getContext();P.fetchFlagSettings(p,g).then(v=>{x.deepEquals(p,V.getContext())&&et(v||{})}).catch(v=>{o.maybeReportError(new N.LDFlagFetchError(E.errorFetchingFlags(v)))})},put:function(p){const v=f(p.data);v&&(n.debug(E.debugStreamPut()),et(v))},patch:function(p){const v=f(p.data);if(!v)return;const I=w[v.key];if(!I||!I.version||!v.version||I.version<v.version){n.debug(E.debugStreamPatch(v.key));const O={},F=x.extend({},v);delete F.key,w[v.key]=F;const L=tt(F);O[v.key]=I?{previous:I.value,current:L}:{current:L},bt(O),_t(v,F)}else n.debug(E.debugStreamPatchIgnored(v.key))},delete:function(p){const v=f(p.data);if(v)if(!w[v.key]||w[v.key].version<v.version){n.debug(E.debugStreamDelete(v.key));const I={};w[v.key]&&!w[v.key].deleted&&(I[v.key]={previous:w[v.key].value}),w[v.key]={version:v.version,deleted:!0},_t(v,w[v.key]),bt(I)}else n.debug(E.debugStreamDeleteIgnored(v.key))}})}function wt(){D&&(T.disconnect(),D=!1)}function et(f){const p={};if(!f)return Promise.resolve();for(const v in w)x.objectHasOwnProperty(w,v)&&w[v]&&(f[v]&&!x.deepEquals(f[v].value,w[v].value)?p[v]={previous:w[v].value,current:tt(f[v])}:f[v]&&!f[v].deleted||(p[v]={previous:w[v].value}));for(const v in f)x.objectHasOwnProperty(f,v)&&f[v]&&(!w[v]||w[v].deleted)&&(p[v]={current:tt(f[v])});return w={...f},zt(),bt(p).catch(()=>{})}function bt(f){const p=Object.keys(f);if(p.length>0){const v={};p.forEach(I=>{const O=f[I].current,F=O?O.value:void 0,L=f[I].previous;o.emit(dt+":"+I,F,L),v[I]=O?{current:F,previous:L}:{previous:L}}),o.emit(dt,v),o.emit(pe,w),s.sendEventsOnlyForVariation||B||p.forEach(I=>{Jt(I,f[I].current)})}return A&&Z?Z.saveFlags(w):Promise.resolve()}function kt(){const f=S||R&&S===void 0;f&&!D?Gt():!f&&D&&wt(),k&&k.setStreaming(f)}function Et(f){return f===dt||f.substr(0,7)===dt+":"}if(typeof s.bootstrap=="string"&&s.bootstrap.toUpperCase()==="LOCALSTORAGE"&&(Z?A=!0:n.warn(E.localStorageUnavailable())),typeof s.bootstrap=="object"&&(w=function(f){const p=Object.keys(f),v="$flagsState",I="$valid",O=f[v];!O&&p.length&&n.warn(E.bootstrapOldFormat()),f[I]===!1&&n.warn(E.bootstrapInvalid());const F={};return p.forEach(L=>{if(L!==v&&L!==I){let z={value:f[L]};O&&O[L]?z=x.extend(z,O[L]):z.version=0,F[L]=z}}),F}(s.bootstrap)),B){const f=B.getInitialState();f?Wt(f):B.on("init",Wt),B.on("update",function(p){p.context&&V.setContext(p.context),p.flags&&et(p.flags)})}else(function(){return t?Kt.processContext(e).then(Bt).then(f=>(V.setContext(f),typeof s.bootstrap=="object"?ot():A?Z.loadFlags().then(p=>p==null?(w={},P.fetchFlagSettings(V.getContext(),g).then(v=>et(v||{})).then(ot).catch(v=>{Dt(new N.LDFlagFetchError(E.errorFetchingFlags(v)))})):(w=p,x.onNextTick(ot),P.fetchFlagSettings(V.getContext(),g).then(v=>et(v)).catch(v=>o.maybeReportError(v)))):P.fetchFlagSettings(V.getContext(),g).then(p=>{w=p||{},zt(),ot()}).catch(p=>{w={},Dt(p)}))):Promise.reject(new N.LDInvalidEnvironmentIdError(E.environmentNotSpecified()))})().catch(Dt);function Wt(f){l=f.environment,V.setContext(f.context),w={...f.flags},x.onNextTick(ot)}function ot(){n.info(E.clientInitialized()),U=!0,kt(),a.signalSuccess()}function Dt(f){a.signalFailure(f)}return{client:{waitForInitialization:()=>a.getInitializationPromise(),waitUntilReady:()=>a.getReadyPromise(),identify:function(f,p,v){if($)return x.wrapPromiseCallback(Promise.resolve({}),v);if(B)return n.warn(E.identifyDisabled()),x.wrapPromiseCallback(Promise.resolve(x.transformVersionedValuesToValues(w)),v);const I=A&&Z?Z.clearFlags():Promise.resolve();return x.wrapPromiseCallback(I.then(()=>Kt.processContext(f)).then(Bt).then(O=>P.fetchFlagSettings(O,p).then(F=>{const L=x.transformVersionedValuesToValues(F);return V.setContext(O),g=p,F?et(F).then(()=>L):L})).then(O=>(D&&Gt(),O)).catch(O=>(o.maybeReportError(O),Promise.reject(O))),v)},getContext:function(){return V.getContext()},variation:function(f,p){return yt(f,p,!0,!1,!1).value},variationDetail:function(f,p){return yt(f,p,!0,!0,!1)},track:function(f,p,v){if(typeof f!="string")return void o.maybeReportError(new N.LDInvalidEventKeyError(E.unknownCustomEventKey(f)));r.customEventFilter&&!r.customEventFilter(f)&&n.warn(E.unknownCustomEventKey(f));const I=V.getContext(),O={kind:"custom",key:f,context:I,url:r.getCurrentUrl(),creationDate:new Date().getTime()};I&&I.anonymous&&(O.contextKind=I.anonymous?"anonymousUser":"user"),p!=null&&(O.data=p),v!=null&&(O.metricValue=v),at(O)},on:function(f,p,v){Et(f)?(R=!0,U&&kt(),o.on(f,p,v)):o.on(...arguments)},off:function(f){if(o.off(...arguments),Et(f)){let p=!1;o.getEvents().forEach(v=>{Et(v)&&o.getEventListenerCount(v)>0&&(p=!0)}),p||(R=!1,D&&S===void 0&&wt())}},setStreaming:function(f){const p=f===null?void 0:f;p!==S&&(S=p,kt())},flush:function(f){return x.wrapPromiseCallback(d?j.flush():Promise.resolve(),f)},allFlags:function(){const f={};if(!w)return f;for(const p in w)x.objectHasOwnProperty(w,p)&&!w[p].deleted&&(f[p]=yt(p,null,!s.sendEventsOnlyForVariation,!1,!0).value);return f},close:function(f){if($)return x.wrapPromiseCallback(Promise.resolve(),f);const p=()=>{$=!0,w={}},v=Promise.resolve().then(()=>{if(wt(),k&&k.stop(),d)return j.stop(),j.flush()}).then(p).catch(p);return x.wrapPromiseCallback(v,f)}},options:s,emitter:o,ident:V,logger:n,requestor:P,start:function(){d&&(k&&k.start(),j.start())},enqueueEvent:at,getFlagsInternal:function(){return w},getEnvironmentId:()=>l,internalChangeEventName:pe}},commonBasicLogger:ve,errors:N,messages:E,utils:x,getContextKeys:Sn},On=ht.initialize,Ln=ht.errors,Tn=ht.messages;function me(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),i.push.apply(i,r)}return i}function $t(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?me(Object(i),!0).forEach(function(r){Rn(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function Un(t){var e=function(i,r){if(typeof i!="object"||!i)return i;var u=i[Symbol.toPrimitive];if(u!==void 0){var n=u.call(i,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(i)}(t,"string");return typeof e=="symbol"?e:e+""}function Rn(t,e,i){return(e=Un(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var jn=ht.commonBasicLogger,Fn=function(t){return jn($t({destination:console.log},t))},he={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function An(t,e,i,r,u){if(u&&!function(){var c=window.navigator&&window.navigator.userAgent;if(c){var d=c.match(/Chrom(e|ium)\/([0-9]+)\./);if(d)return parseInt(d[2],10)<73}return!0}())return he;var n=new window.XMLHttpRequest;for(var o in n.open(t,e,!u),i||{})Object.prototype.hasOwnProperty.call(i,o)&&n.setRequestHeader(o,i[o]);if(u){try{n.send(r)}catch{}return he}var a,s=new Promise(function(c,d){n.addEventListener("load",function(){a||c({status:n.status,header:function(l){return n.getResponseHeader(l)},body:n.responseText})}),n.addEventListener("error",function(){a||d(new Error)}),n.send(r)});return{promise:s,cancel:function(){a=!0,n.abort()}}}var Nt=t=>{if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};function Nn(t,e,i,r){var u,n,o=((t.kind==="substring"||t.kind==="regex")&&r.includes("/")?e:e.replace(r,"")).replace(i,"");switch(t.kind){case"exact":n=e,u=new RegExp("^"+Nt(t.url)+"/?$");break;case"canonical":n=o,u=new RegExp("^"+Nt(t.url)+"/?$");break;case"substring":n=o,u=new RegExp(".*"+Nt(t.substring)+".*$");break;case"regex":n=o,u=new RegExp(t.pattern);break;default:return!1}return u.test(n)}function ye(t,e){for(var i={},r=null,u=[],n=0;n<t.length;n++)for(var o=t[n],a=o.urls||[],s=0;s<a.length;s++)if(Nn(a[s],window.location.href,window.location.search,window.location.hash)){o.kind==="pageview"?e("pageview",o):(u.push(o),e("click_pageview",o));break}return u.length>0&&(r=function(c){for(var d=function(g,m){for(var h=[],b=0;b<m.length;b++)for(var C=g.target,y=m[b],k=y.selector,T=document.querySelectorAll(k);C&&T.length>0;){for(var j=0;j<T.length;j++)C===T[j]&&h.push(y);C=C.parentNode}return h}(c,u),l=0;l<d.length;l++)e("click",d[l])},document.addEventListener("click",r)),i.dispose=function(){document.removeEventListener("click",r)},i}var $n=300;function Vn(t,e){var i,r;function u(){r&&r.dispose(),i&&i.length&&(r=ye(i,n))}function n(o,a){var s=t.ident.getContext(),c={kind:o,key:a.key,data:null,url:window.location.href,creationDate:new Date().getTime(),context:s};return o==="click"&&(c.selector=a.selector),t.enqueueEvent(c)}return t.requestor.fetchJSON("/sdk/goals/"+t.getEnvironmentId()).then(function(o){o&&o.length>0&&(r=ye(i=o,n),function(a,s){var c,d=window.location.href;function l(){(c=window.location.href)!==d&&(d=c,s())}(function g(m,h){m(),setTimeout(function(){g(m,h)},h)})(l,a),window.history&&window.history.pushState?window.addEventListener("popstate",l):window.addEventListener("hashchange",l)}($n,u)),e()}).catch(function(o){t.emitter.maybeReportError(new Ln.LDUnexpectedResponseError((o&&o.message,o.message))),e()}),{}}var ft="goalsReady",Hn={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};function qn(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=function(d){var l,g={userAgentHeaderName:"X-LaunchDarkly-User-Agent",synchronousFlush:!1};if(window.XMLHttpRequest){var m=d&&d.disableSyncEventPost;g.httpRequest=function(y,k,T,j){var P=g.synchronousFlush&!m;return g.synchronousFlush=!1,An(y,k,T,j,P)}}g.httpAllowsPost=function(){return l===void 0&&(l=!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest),l},g.httpFallbackPing=function(y){new window.Image().src=y};var h,b=d&&d.eventUrlTransformer;g.getCurrentUrl=function(){return b?b(window.location.href):window.location.href},g.isDoNotTrack=function(){var y;return(y=window.navigator&&window.navigator.doNotTrack!==void 0?window.navigator.doNotTrack:window.navigator&&window.navigator.msDoNotTrack!==void 0?window.navigator.msDoNotTrack:window.doNotTrack)===1||y===!0||y==="1"||y==="yes"};try{window.localStorage&&(g.localStorage={get:function(y){return new Promise(function(k){k(window.localStorage.getItem(y))})},set:function(y,k){return new Promise(function(T){window.localStorage.setItem(y,k),T()})},clear:function(y){return new Promise(function(k){window.localStorage.removeItem(y),k()})}})}catch{g.localStorage=null}if(d&&d.useReport&&typeof window.EventSourcePolyfill=="function"&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(g.eventSourceAllowsReport=!0,h=window.EventSourcePolyfill):(g.eventSourceAllowsReport=!1,h=window.EventSource),window.EventSource){var C=3e5;g.eventSourceFactory=function(y,k){var T=$t($t({},{heartbeatTimeout:C,silentTimeout:C,skipDefaultHeaders:!0}),k);return new h(y,T)},g.eventSourceIsActive=function(y){return y.readyState===window.EventSource.OPEN||y.readyState===window.EventSource.CONNECTING}}return g.userAgent="JSClient",g.version="3.2.0",g.diagnosticSdkData={name:"js-client-sdk",version:"3.2.0"},g.diagnosticPlatformData={name:"JS"},g.diagnosticUseCombinedEvent=!0,g}(i),u=On(t,e,i,r,Hn),n=u.client,o=u.options,a=u.emitter,s=new Promise(function(d){var l=a.on(ft,function(){a.off(ft,l),d()})});n.waitUntilGoalsReady=function(){return s},o.fetchGoals?Vn(u,function(){return a.emit(ft)}):a.emit(ft),document.readyState!=="complete"?window.addEventListener("load",u.start):u.start();var c=function(){r.synchronousFlush=!0,n.flush().catch(function(){}),r.synchronousFlush=!1};return document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&c()}),window.addEventListener("pagehide",c),n}var _n=Fn,zn=void 0,Mn="3.2.0",Jn={initialize:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return console&&console.warn&&console.warn(Tn.deprecated("default export","named LDClient export")),qn(t,e,i)},version:Mn};export{_n as basicLogger,zn as createConsoleLogger,Jn as default,qn as initialize,Mn as version};
