import{d as K,i as u,q as T,n as S,t as N,v as $,m as se,a as O,w as C,o as q,f as I,F as G,A as ae,j as b,k as A,B as F,s as R,l as W,x as k,S as re,U as ce,z as p,D as ie,aj as le,c as Q,b as ue,Q as de}from"./vue-6PFCaG3D.js";import{_ as B,u as E,c as x,s as L,p as pe,b as me,d as ve,e as fe}from"./index-fTqu791Z.js";import{g as _e}from"./getMessageFromError-KCSW6jpt.js";import{h as ge}from"./document-l6RdaXdg.js";import{U as he}from"./specRenderer-IjoYWasr.js";/* empty css              */import{f as Se}from"./fetchAll-gydFt7zS.js";import"./kongponents-3HpDyT6r.js";const ye={key:0,class:"mb-3"},Ie=K({__name:"Section",props:{title:{type:String,default:null}},setup(e){return(m,c)=>(u(),T("section",null,[e.title?(u(),T("header",ye,[S("h2",null,N(e.title),1)])):$("",!0),se(m.$slots,"default",{},void 0,!0)]))}}),H=B(Ie,[["__scopeId","data-v-13bc53f2"]]),be=K({name:"DocumentTree",props:{documents:{type:Array,required:!0},productId:{type:String,required:!0},activeDocumentId:{type:String,default:null},level:{type:Number,default:1},parentDocumentSlug:{type:String,default:""}},setup:e=>{const m=O({});function c(o,s){const l=s.reduce((d,f)=>(d[f.id]=!0,d),{});if(o){m.value=l;const d=s.find(f=>f.id===o||ge(f.children||[],o));d&&(l[d.id]=!1)}m.value=l}return C([()=>e.activeDocumentId,()=>e.documents],([o,s])=>{c(o,s)}),q(()=>{c(e.activeDocumentId,e.documents)}),{isNodeCollapsedMap:m}}}),De=e=>(re("data-v-71b5b1f1"),e=e(),ce(),e),we=De(()=>S("div",null,null,-1)),Ve={class:"expandable-node-container"},Pe=["onClick"],Ae={class:"children",role:"region",tabindex:"-1"};function Te(e,m,c,o,s,l){const d=I("router-link"),f=I("KIcon"),_=I("DocumentTree",!0),g=I("KCollapse");return u(),T("ul",null,[(u(!0),T(G,null,ae(e.documents,t=>(u(),T("li",{key:t.id},[t.children&&t.children.length?(u(),b(g,{key:0,modelValue:e.isNodeCollapsedMap[t.id],"onUpdate:modelValue":r=>e.isNodeCollapsedMap[t.id]=r,class:"collapse-container"},{trigger:A(()=>[we]),"visible-content":A(()=>[S("div",Ve,[k(d,{to:{name:"api-documentation-page",params:{product:e.productId,slug:[e.parentDocumentSlug,t.slug].filter(Boolean)}},style:F({paddingLeft:`${e.level-1}rem`}),class:R({title:!0})},{default:A(()=>[W(N(t.title),1)]),_:2},1032,["to","style"]),S("button",{class:R(["expand-button",e.isNodeCollapsedMap[t.id]?null:"expand-icon"]),onClick:r=>e.isNodeCollapsedMap[t.id]=!e.isNodeCollapsedMap[t.id]},[k(f,{icon:"chevronDown",size:"16"})],10,Pe)])]),default:A(()=>[S("div",null,[S("div",Ae,[k(_,{documents:t.children,"active-document-id":e.activeDocumentId,"product-id":e.productId,level:e.level+1,"parent-document-slug":t.slug},null,8,["documents","active-document-id","product-id","level","parent-document-slug"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])):(u(),b(d,{key:1,to:{name:"api-documentation-page",params:{product:e.productId,slug:[e.parentDocumentSlug,t.slug].filter(Boolean)}},class:R({title:!0}),style:F({paddingLeft:`${e.level-1}rem`})},{default:A(()=>[W(N(t.title),1)]),_:2},1032,["to","style"]))]))),128))])}const ke=B(be,[["render",Te],["__scopeId","data-v-71b5b1f1"]]),$e=K({__name:"SectionOverview",props:{product:{type:Object,required:!0}},setup(e){const m=E().state.helpText.sectionOverview,c=e,o=x(),{documentTree:s,activeDocumentId:l}=L(o);return(d,f)=>p(s).length&&c.product?(u(),b(H,{key:0,title:p(m).title},{default:A(()=>[k(ke,{documents:p(s),"product-id":c.product.id,"active-document-id":p(l)},null,8,["documents","product-id","active-document-id"])]),_:1},8,["title"])):$("",!0)}}),Ce=K({__name:"SectionReference",props:{product:{type:Object,required:!0},activeProductVersionId:{type:String,required:!0},deselectOperation:{type:Boolean,default:!1}},emits:["operationSelected"],setup(e,{emit:m}){const c=O(null),o=O(!0),s=e,l=m,d=x();async function f(){var t,r;const _=(t=s.product)==null?void 0:t.id,g=s.activeProductVersionId;if(!(!_||!g)){o.value=!0;try{const i=await pe.service.versionsApi.getProductVersionSpecOperations({productId:_,productVersionId:g});c.value=(r=i.data.operations)==null?void 0:r.map(h=>({...h,operationId:h.operation_id})),d.setSidebarOperations(c.value)}catch(i){console.error(i)}finally{o.value=!1}}}return f(),C([()=>s.product,()=>s.activeProductVersionId],f),(_,g)=>{const t=I("KSkeleton");return e.product&&e.product.versions.length?(u(),b(H,{key:0},{default:A(()=>[o.value?(u(),b(t,{key:0})):c.value?(u(),b(p(he),{key:1,operations:c.value,deselect:e.deselectOperation,width:"100%",class:"operations-list",onSelected:g[0]||(g[0]=r=>l("operationSelected",r))},null,8,["operations","deselect"])):$("",!0)]),_:1})):$("",!0)}}}),Oe=B(Ce,[["__scopeId","data-v-0e10c61f"]]),Ke={class:"px-5 py-6 content"},Ne={class:"mb-6"},Be=["title"],Me=K({__name:"Sidebar",props:{deselectOperation:{type:Boolean,default:!1}},emits:["operationSelected"],setup(e,{emit:m}){const c=x(),{product:o,activeProductVersionId:s}=L(c),l=E().state.helpText.sidebar,d=l.noResultsProduct,f=m,_=O([]);function g(){var r;_.value=((r=o.value)==null?void 0:r.versions.slice().sort((i,h)=>new Date(i.created_at).getTime()-new Date(h.created_at).getTime()).map(i=>({value:i.id,label:`${i.name}${i.deprecated?l.deprecated:""}`,selected:i.id===s.value})))||[]}function t(r){var h;const i=(h=o.value)==null?void 0:h.versions.find(y=>y.id===r.value);i&&c.setActiveProductVersionId(i.id)}return q(()=>{g()}),C([()=>o.value,()=>s.value],()=>{g()}),(r,i)=>{var D,V;const h=I("KAlert"),y=I("KSelect");return u(),T("aside",null,[S("div",Ke,[S("header",Ne,[S("span",{class:"title mb-5",title:(D=p(o))==null?void 0:D.name},N((V=p(o))==null?void 0:V.name),9,Be),p(o)&&!_.value.length?(u(),b(h,{key:0,appearance:"warning","alert-message":p(l).noVersions,class:"mb-4"},null,8,["alert-message"])):$("",!0),k(y,{appearance:"select",class:"version-select-dropdown",width:"100%","data-testid":"version-select-dropdown","enable-filtering":!1,items:_.value,onChange:t},{empty:A(()=>[S("div",null,N(p(d)),1)]),_:1},8,["items"])]),k($e,{product:p(o)},null,8,["product"]),p(s)?(u(),b(Oe,{key:0,"active-product-version-id":p(s),product:p(o),"deselect-operation":e.deselectOperation,onOperationSelected:i[0]||(i[0]=M=>f("operationSelected",M))},null,8,["active-product-version-id","product","deselect-operation"])):$("",!0)])])}}}),xe=B(Me,[["__scopeId","data-v-c1f7535a"]]);function Re(e,m="asc"){return(c,o)=>{const s=new Date(c[e]).getTime(),l=new Date(o[e]).getTime();return s===l?0:m==="asc"?s>l?1:-1:s<l?1:-1}}const qe={class:"container flex pb-0 product fixed-position"},Ee={class:"sidebar-wrapper"},Le={class:"content"},Ue=K({__name:"ProductShell",setup(e){const{notify:m}=fe(),c=E().state.helpText,o=ie(),s=le(),{portalApiV2:l}=me(),d=O(null),f=O(!1),_=O(!1),g=c.productVersion.deprecatedWarningProduct,t=x(),{product:r,documentTree:i,activeDocumentSlug:h,activeProductVersionId:y}=L(t),D=Q(()=>o.params.product),V=Q(()=>o.params.product_version);function M(){const n=o.params.slug,a=Array.isArray(n)?n[n.length-1]:n;a!==h.value&&t.setActiveDocumentSlug(a)}const{productsApi:J,versionsApi:X,documentationApi:Y}=l.value.service;async function Z(){var a;const n=D.value;try{const{data:v}=await J.getProduct({productId:n}),w={...v,versions:await Se(P=>X.listProductVersions({...P,productId:n}))};t.setProduct(w)}catch(v){t.setProduct(null),console.error(v),((a=v.response)==null?void 0:a.status)===404&&s.push({name:"not-found"}),d.value=_e(v)}}async function ee(){const n=D.value;try{const a={productId:n};if(t.product){const v=await Y.listProductDocuments(a,{headers:{accept:ve.DocumentContentTypeEnum.VndKonnectDocumentTreejson}});t.setDocumentTree(v.data.data)}}catch(a){a.response.status===404?t.setDocumentTree([]):(console.error(a),m({appearance:"danger",message:c.productVersion.unableToRetrieveDoc}))}}function U(){var v,w;if(!r.value)return;const n=r.value.versions.slice().sort(Re("created_at"));if(!n)return;const a=(v=V.value)==null?void 0:v.toLowerCase();if(a){const P=n.find(j=>{var z;return j.id===a||((z=j.name)==null?void 0:z.toLowerCase())===a});P&&t.setActiveProductVersionId(P.id)}y.value||t.setActiveProductVersionId((w=n[n.length-1])==null?void 0:w.id)}function te(n){n&&s.replace({name:"api-documentation-page",params:{product:o.params.product,slug:[n]}})}function oe(){o.name==="spec"&&(t.setSidebarActiveOperation(null),s.push({name:"spec",params:{product:D.value,product_version:y.value}}))}function ne(n){const a={name:"spec",params:{product:D.value,product_version:y.value}};o.name!=="spec"?s.push(a).then(()=>t.setSidebarActiveOperation(n)):s.replace(a).then(()=>t.setSidebarActiveOperation(n))}return q(async()=>{M(),await Z(),await ee(),U()}),ue(()=>{t.setProduct(null)}),C(()=>V.value,()=>{V.value&&V.value!==y.value&&t.setActiveProductVersionId(V.value),U()}),C(()=>o.name,()=>{_.value=o.name!=="spec"}),C(()=>y.value,(n,a)=>{var w;if(a&&n!==a&&oe(),!((w=r.value)!=null&&w.version_count))return;const v=r.value.versions.filter(P=>P.id===y.value)[0];f.value=v==null?void 0:v.deprecated}),C(()=>D.value,()=>{var n;D.value!==((n=r.value)==null?void 0:n.id)&&t.setProduct(null)}),de(()=>{var n;if(M(),i.value&&!h.value&&o.path.includes("/docs/")){const a=(n=i.value[0])==null?void 0:n.slug;te(a)}}),(n,a)=>{const v=I("EmptyState"),w=I("KAlert"),P=I("router-view");return u(),T("div",qe,[d.value?(u(),b(v,{key:0,"is-error":"",class:"mt-6",message:d.value},null,8,["message"])):p(r)?(u(),T(G,{key:1},[S("div",Ee,[k(xe,{class:"sidebar","deselect-operation":_.value,onOperationSelected:ne},null,8,["deselect-operation"])]),S("div",Le,[f.value?(u(),b(w,{key:0,appearance:"warning","alert-message":p(g),class:"deprecated-warning"},null,8,["alert-message"])):$("",!0),k(P,{product:p(r)},null,8,["product"])])],64)):$("",!0)])}}}),Xe=B(Ue,[["__scopeId","data-v-fd1d5fae"]]);export{Xe as default};
